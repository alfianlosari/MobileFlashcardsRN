Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.clearLocalNotification = clearLocalNotification;
exports.setLocalNotification = setLocalNotification;

var _reactNative = require('react-native');

var _expo = require('expo');

var NOTIFICATION_KEY = 'MobileFlashcards::Notifications';

function clearLocalNotification() {
    return _reactNative.AsyncStorage.removeItem(NOTIFICATION_KEY).then(_expo.Notifications.cancelAllScheduledNotificationsAsync);
}

function createNotification() {
    return {
        title: 'Mobile Flashcards',
        body: 'Don\'t forget to take a quiz today!',
        ios: {
            sound: true
        },
        android: {
            sound: true,
            priority: 'high',
            sticky: false,
            vibrate: true
        }
    };
}

function setLocalNotification() {
    _reactNative.AsyncStorage.getItem(NOTIFICATION_KEY).then(JSON.parse).then(function (data) {
        if (data === null) {
            _expo.Permissions.askAsync(_expo.Permissions.NOTIFICATIONS).then(function (_ref) {
                var status = _ref.status;

                console.log(status);
                if (status === 'granted' || status == 'undetermined') {
                    _expo.Notifications.cancelAllScheduledNotificationsAsync();
                    var tommorow = new Date();
                    tommorow.setDate(tommorow.getDate() + 1);
                    tommorow.setHours(8);
                    tommorow.setMinutes(0);
                    _expo.Notifications.scheduleLocalNotificationAsync(createNotification(), {
                        time: tommorow,
                        repeat: 'day'
                    });
                    _reactNative.AsyncStorage.setItem(NOTIFICATION_KEY, JSON.stringify(true));
                }
            });
        }
    });
}